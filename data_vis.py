import pandas as pd
from scipy.signal import argrelextrema
import numpy as np

# chris 
#time = [0.002, 0.374, 0.723, 1.073, 1.423, 1.772, 2.122, 2.473, 2.833, 3.194, 3.555, 3.917, 4.268, 4.619, 4.96, 5.311, 5.663, 6.015, 6.367, 6.719, 7.071, 7.435, 7.787, 8.14, 8.493, 8.846, 9.21, 9.564, 9.918, 10.271, 10.625, 10.99, 11.345, 11.699, 12.054, 12.409, 12.764, 13.12, 13.475, 13.831, 14.187, 14.564, 14.942, 15.287, 15.644, 16.0, 16.346, 16.703, 17.071, 17.428, 17.796, 18.154, 18.522, 18.88, 19.249, 19.607, 19.965, 20.324, 20.671, 21.041, 21.411, 21.854, 22.315, 22.759, 23.203, 23.648, 24.092, 24.538, 24.983, 25.429, 25.875, 26.321, 26.767, 27.231, 27.678, 28.124, 28.572, 29.001, 29.467, 29.932, 30.38, 30.828, 31.276, 31.707, 32.156, 32.605, 33.055, 33.504, 33.954, 34.439, 34.925, 35.41, 35.861, 36.294, 36.78, 37.249, 37.683, 38.134, 38.586, 39.038, 39.508, 39.96, 40.413, 40.866, 41.336, 41.79, 42.261, 42.733, 43.186, 43.64, 44.095, 44.567, 45.022, 45.476, 45.95, 46.387, 46.842, 47.298, 47.754, 48.228, 48.684, 49.123, 49.579, 50.054, 50.53, 50.987, 51.444, 51.902, 52.397, 52.856, 53.315, 53.793, 54.253, 54.731, 55.192, 55.652, 56.113, 56.574, 57.054, 57.516, 57.978, 58.458, 58.939, 59.402, 59.864]
#voltage = [0.02578164, 1.155592, 2.109764, 1.593175, 1.345782, 1.496493, 1.021799, 0.5705195, 0.8775829, 0.4657816, 0.7647379, 3.192845, 1.113696, 3.17512, 1.930854, 3.172703, 1.999336, 1.178151, 1.465878, 1.121753, 0.5262074, 1.279716, 3.167063, 1.187013, 1.278105, 0.5721309, 1.258769, 1.457015, 0.769572, 3.172703, 0.9863492, 3.165452, 1.641515, 3.188817, 2.241895, 3.170286, 1.803506, 3.184788, 1.901849, 2.660142, 0.08701304, 0.02336461, 3.17512, 1.943745, 3.168675, 1.44493, 3.021991, 0.8397161, 3.184788, 0.6616113, 3.192039, 0.9613732, 3.192845, 0.7590981, 3.201707, 0.549572, 3.191234, 1.75436, 0.9533165, 0.7655436, 1.278911, 0.5076768, 1.162843, 2.010616, 3.191234, 1.046825, 3.191234, 1.166871, 1.008908, 2.419194, 1.393317, 3.173509, 0.8687205, 1.125782, 1.796255, 1.905072, 3.20493, 0.5834104, 0.8066331, 2.317679, 1.607677, 3.195262, 1.32564, 1.838956, 3.179148, 3.189622, 1.209572, 3.173509, 0.01933623, 0.02578164, 0.02497597, 1.396539, 3.16948, 0.07895628, 0.3311833, 3.17512, 1.292607, 3.168675, 0.774406, 0.9654016, 1.829288, 1.561753, 3.167869, 0.6487205, 3.200902, 0.5979125, 0.2433646, 2.195971, 1.595592, 3.171897, 0.8598581, 1.452181, 3.170286, 0.5809934, 3.17512, 0.769572, 1.614122, 1.193458, 0.4464454, 1.182179, 2.25398, 3.179954, 0.4069169, 0.4746441, 3.173509, 0.827631, 3.175926, 0.02497597, 1.792227, 3.174314, 0.4786725, 3.168675, 0.3384344, 1.742275, 1.665736, 1.656873, 3.178343, 0.6011353, 1.713271, 3.197679, 0.3658274, 0.5455436, 3.178343, 0.917061, 3.200096]

#trey1
#time = [0.002, 0.373, 0.744, 1.104, 1.453, 1.803, 2.153, 2.503, 2.854, 3.204, 3.555, 3.906, 4.256, 4.608, 4.959, 5.31, 5.662, 6.014, 6.366, 6.718, 7.07, 7.423, 7.776, 8.128, 8.481, 8.834, 9.188, 9.541, 9.895, 10.249, 10.603, 10.957, 11.311, 11.666, 12.021, 12.376, 12.731, 13.086, 13.442, 13.797, 14.153, 14.509, 14.865, 15.221, 15.578, 15.934, 16.302, 16.659, 17.016, 17.373, 17.73, 18.088, 18.445, 18.803, 19.161, 19.519, 19.877, 20.236, 20.594, 20.953, 21.323, 21.766, 22.227, 22.688, 23.149, 23.611, 24.038, 24.484, 24.929, 25.392, 25.855, 26.319, 26.765, 27.229, 27.675, 28.14, 28.604, 28.982, 29.447, 29.912, 30.36, 30.825, 31.274, 31.74, 32.206, 32.673, 33.14, 33.589, 34.021, 34.471, 34.921, 35.371, 35.822, 36.273, 36.723, 37.174, 37.644, 38.095, 38.547, 38.998, 39.451, 39.903, 40.355, 40.826, 41.297, 41.768, 42.239, 42.693, 43.147, 43.6, 44.055, 44.509, 44.964, 45.418, 45.855, 46.328, 46.802, 47.276, 47.731, 48.187, 48.644, 49.1, 49.557, 50.014, 50.471, 50.928, 51.385, 51.843, 52.301, 52.778, 53.237, 53.697, 54.157, 54.617, 55.077, 55.538, 56.017, 56.478, 56.939, 57.401, 57.863, 58.325, 58.805, 59.268, 59.73]
#voltage = [0.03303273, 0.03383841, 0.8163012, 1.025022, 1.104028, 1.252323, 1.271659, 1.328057, 1.312749, 1.360284, 1.261186, 1.381231, 1.312749, 1.360284, 1.340948, 1.419904, 1.397345, 1.500522, 1.523886, 1.465072, 1.469906, 1.515024, 1.473935, 1.490854, 1.493271, 1.442463, 1.415875, 1.487631, 1.428766, 1.271659, 1.461044, 1.431183, 1.448153, 1.696352, 2.372465, 2.534456, 2.193555, 1.692323, 1.543223, 1.334502, 1.687489, 2.494173, 1.992085, 1.215212, 1.050854, 0.9887663, 1.539194, 2.155688, 1.830899, 1.053271, 0.827631, 1.271659, 2.167773, 1.054882, 1.012937, 0.799382, 1.922797, 1.376397, 1.045214, 0.8961135, 1.000046, 0.9508995, 0.8654978, 0.8993362, 0.9549278, 1.04602, 1.007297, 1.030661, 0.8783886, 0.8679149, 0.9992401, 1.039574, 0.9267292, 1.098389, 0.9363974, 0.8509956, 0.88, 0.5882444, 0.6511375, 1.051659, 0.9517052, 1.036352, 0.6753078, 0.4561135, 0.6318013, 0.8534126, 1.058105, 2.21853, 3.170286, 1.654456, 0.974264, 1.179762, 1.234548, 1.112891, 0.604358, 0.8009933, 2.279812, 3.148533, 2.143603, 0.964596, 1.063745, 1.257157, 0.8453559, 0.6221332, 0.6108034, 0.7059236, 1.293413, 2.768153, 2.876919, 2.092845, 1.141895, 1.090332, 1.242655, 1.28455, 0.5737423, 0.7566812, 0.8566353, 1.336113, 2.834218, 3.076777, 2.595688, 1.074218, 1.173316, 1.235354, 1.309526, 1.328057, 1.323223, 1.002463, 0.6720851, 1.690712, 3.105026, 2.473175, 1.001657, 1.215212, 1.279716, 0.6051636, 1.361895, 3.021186, 1.942939, 1.013742, 1.485214, 0.8453559, 1.003268, 2.826967, 1.151563]

#trey2
#time = [0.002, 0.353, 0.703, 1.053, 1.403, 1.753, 2.104, 2.454, 2.805, 3.156, 3.507, 3.858, 4.21, 4.561, 4.913, 5.265, 5.617, 5.969, 6.311, 6.663, 7.016, 7.369, 7.722, 8.075, 8.428, 8.782, 9.136, 9.49, 9.844, 10.198, 10.552, 10.907, 11.262, 11.617, 11.972, 12.327, 12.683, 13.039, 13.394, 13.75, 14.107, 14.452, 14.808, 15.165, 15.522, 15.879, 16.236, 16.593, 16.94, 17.297, 17.655, 18.002, 18.338, 18.685, 19.044, 19.391, 19.75, 20.109, 20.457, 20.816, 21.175, 21.619, 22.062, 22.507, 22.934, 23.379, 23.824, 24.27, 24.716, 25.162, 25.608, 26.037, 26.484, 26.931, 27.36, 27.808, 28.255, 28.703, 29.151, 29.599, 30.048, 30.496, 30.945, 31.394, 31.843, 32.275, 32.725, 33.175, 33.625, 34.075, 34.508, 34.958, 35.409, 35.86, 36.312, 36.763, 37.215, 37.667, 38.119, 38.571, 39.024, 39.477, 39.93, 40.383, 40.836, 41.272, 41.726, 42.18, 42.634, 43.089, 43.543, 43.998, 44.453, 44.908, 45.364, 45.783, 46.239, 46.695, 47.152, 47.608, 48.065, 48.522, 48.979, 49.436, 49.894, 50.351, 50.809, 51.267, 51.726, 52.185, 52.645, 53.105, 53.565, 54.025, 54.486, 54.947, 55.409, 55.87, 56.332, 56.794, 57.256, 57.719, 58.181, 58.644, 59.089, 59.552]
#voltage = [1.739858, 1.831705, 1.652845, 1.715688, 1.775308, 1.577867, 1.788199, 2.630332, 1.371563, 1.493271, 2.741565, 1.721328, 1.610094, 1.499716, 1.572227, 3.034076, 1.722133, 1.53436, 1.473935, 1.464266, 2.844692, 1.723744, 1.236965, 2.201611, 1.897015, 1.800284, 1.522275, 1.753555, 2.724646, 1.516635, 1.430378, 2.612607, 1.901849, 1.793838, 1.502939, 1.601231, 2.292703, 1.499716, 2.887393, 1.442463, 1.29583, 1.598814, 1.950996, 3.123557, 1.671376, 1.194264, 1.797061, 1.97436, 2.232227, 1.490854, 1.50455, 2.7891, 1.70038, 1.285356, 1.84379, 1.996919, 2.195971, 1.56981, 1.425544, 2.752845, 1.741469, 1.307109, 3.107443, 1.37398, 1.931659, 2.364408, 1.498105, 1.777725, 1.276493, 2.424028, 1.47474, 1.579478, 2.483699, 1.51019, 1.876068, 1.282939, 3.043745, 1.485214, 2.028341, 2.398247, 1.517441, 1.961469, 1.462655, 2.029146, 1.59962, 1.059716, 3.067109, 1.473129, 2.027535, 2.28948, 1.564976, 1.982417, 1.468295, 1.532749, 1.657679, 1.012131, 2.897111, 1.465878, 1.637487, 3.064692, 1.532749, 2.063035, 1.192653, 3.188817, 1.43924, 2.062179, 1.779336, 1.908295, 1.523081, 1.068579, 2.887393, 1.539194, 2.037203, 2.038009, 2.0864, 1.809146, 1.169288, 2.944646, 1.458627, 1.626207, 3.167063, 1.482797, 1.893793, 1.112085, 3.165452, 1.509384, 1.887347, 1.854264, 1.561753, 3.116306, 1.519858, 1.116114, 1.867205, 1.495688, 2.178247, 1.683461, 2.087205, 2.021895, 1.864788, 1.713271, 1.712465, 2.617441, 2.810854, 1.43924, 1.580284, 3.179148]

#hunter1
#time = [0.002, 0.354, 0.704, 1.054, 1.404, 1.754, 2.105, 2.445, 2.795, 3.146, 3.497, 3.849, 4.2, 4.552, 4.903, 5.255, 5.607, 5.959, 6.312, 6.664, 7.017, 7.37, 7.723, 8.076, 8.43, 8.773, 9.126, 9.48, 9.834, 10.189, 10.543, 10.898, 11.252, 11.586, 11.941, 12.297, 12.652, 13.008, 13.364, 13.72, 14.076, 14.432, 14.778, 15.135, 15.491, 15.848, 16.206, 16.563, 16.92, 17.278, 17.636, 17.994, 18.351, 18.71, 19.068, 19.426, 19.785, 20.144, 20.503, 20.862, 21.221, 21.665, 22.109, 22.536, 22.98, 23.426, 23.871, 24.317, 24.763, 25.209, 25.655, 26.102, 26.548, 26.978, 27.425, 27.838, 28.285, 28.733, 29.163, 29.612, 30.06, 30.509, 30.958, 31.407, 31.856, 32.305, 32.755, 33.205, 33.655, 34.088, 34.521, 34.971, 35.422, 35.874, 36.325, 36.777, 37.229, 37.681, 38.115, 38.567, 39.02, 39.473, 39.926, 40.379, 40.832, 41.286, 41.74, 42.194, 42.648, 43.103, 43.557, 44.012, 44.45, 44.905, 45.36, 45.816, 46.272, 46.728, 47.184, 47.641, 48.098, 48.555, 49.012, 49.469, 49.927, 50.385, 50.843, 51.301, 51.759, 52.219, 52.678, 53.138, 53.599, 54.059, 54.52, 54.981, 55.442, 55.904, 56.366, 56.828, 57.29, 57.753, 58.197, 58.66, 59.104, 59.567]
#voltage = [1.696352, 1.674598, 2.046871, 1.711659, 2.353129, 1.780948, 2.25398, 1.863983, 2.118627, 1.892987, 2.106541, 1.908295, 2.379716, 1.847013, 2.492561, 1.977583, 2.349906, 1.873651, 1.614122, 1.936493, 1.800284, 1.800284, 1.744692, 1.809146, 1.78981, 1.877679, 1.687489, 2.728675, 1.809952, 1.755166, 1.774502, 1.793838, 2.7891, 1.800284, 1.693129, 1.656873, 1.737441, 2.478865, 1.768862, 1.768057, 1.738247, 1.82526, 1.756777, 1.781753, 1.973555, 1.821231, 1.951801, 1.834122, 1.972749, 1.900238, 2.416777, 1.798672, 1.880096, 1.964692, 1.816397, 1.789004, 1.850236, 1.999336, 1.812369, 2.453033, 1.891376, 2.518343, 1.76564, 1.801895, 1.832511, 1.857537, 2.229004, 1.999336, 1.976777, 2.564266, 1.744692, 1.626207, 1.85507, 1.996919, 2.5691, 1.683461, 1.672987, 1.82526, 1.869622, 2.357157, 1.775308, 1.903461, 2.852749, 1.526303, 1.588341, 1.704408, 1.908295, 2.935784, 1.62943, 1.54564, 1.782559, 1.906683, 2.177441, 1.660902, 2.017867, 2.166967, 1.820426, 1.89621, 2.180664, 2.772181, 1.434406, 1.589952, 1.803506, 2.742371, 1.587535, 1.751943, 3.173509, 1.531137, 1.946967, 3.058247, 1.646349, 1.54564, 1.686683, 1.976777, 2.463506, 1.696352, 2.062179, 2.428862, 1.573838, 1.829288, 2.183887, 1.994502, 1.390094, 1.481186, 2.156493, 1.298247, 1.402179, 1.892181, 1.477157, 1.544834, 1.198292, 1.509384, 2.864834, 1.299052, 2.054122, 1.286967, 1.886541, 1.321611, 1.715688, 1.405402, 1.643932, 3.15659, 1.236965, 2.39019, 1.555308, 1.737441]

#chris2
#time = [0.002, 0.174, 0.345, 0.515, 0.686, 0.856, 1.028, 1.199, 1.36, 1.511, 1.662, 1.823, 1.975, 2.126, 2.257, 2.409, 2.582, 2.734, 2.887, 3.039, 3.202, 3.355, 3.508, 3.661, 3.815, 3.968, 4.122, 4.286, 4.441, 4.595, 4.749, 4.903, 5.058, 5.213, 5.368, 5.523, 5.679, 5.835, 5.99, 6.157, 6.313, 6.469, 6.626, 6.782, 6.939, 7.096, 7.253, 7.41, 7.568, 7.725, 7.883, 8.041, 8.199, 8.368, 8.526, 8.684, 8.843, 9.002, 9.16, 9.32, 9.479, 9.722, 9.966, 10.21, 10.455, 10.7, 10.945, 11.191, 11.437, 11.683, 11.929, 12.175, 12.422, 12.669, 12.916, 13.163, 13.411, 13.658, 13.889, 14.137, 14.385, 14.634, 14.882, 15.131, 15.38, 15.63, 15.879, 16.129, 16.379, 16.629, 16.88, 17.13, 17.381, 17.632, 17.883, 18.135, 18.387, 18.638, 18.891, 19.143, 19.395, 19.648, 19.901, 20.154, 20.389, 20.643, 20.897, 21.15, 21.405, 21.659, 21.914, 22.168, 22.423, 22.678, 22.934, 23.189, 23.445, 23.701, 23.939, 24.195, 24.452, 24.709, 24.966, 25.205, 25.462, 25.72, 25.978, 26.236, 26.494, 26.735, 26.995, 27.254, 27.514, 27.775, 28.036, 28.297, 28.558, 28.819, 29.081, 29.325, 29.587, 29.849, 30.112, 30.374, 30.637, 30.901, 31.164, 31.428, 31.692, 31.955, 32.201, 32.465, 32.73, 32.995, 33.26, 33.525, 33.79, 34.056, 34.322, 34.588, 34.854, 35.121, 35.387, 35.654, 35.922, 36.189, 36.438, 36.705, 36.973, 37.241, 37.51, 37.778, 38.047, 38.316, 38.586, 38.855, 39.125, 39.395, 39.665, 39.935, 40.206, 40.476, 40.747, 41.018, 41.29, 41.561, 41.833, 42.105, 42.358, 42.63, 42.903, 43.156, 43.43, 43.703, 43.976, 44.25, 44.524, 44.798, 45.053, 45.327, 45.582, 45.857, 46.132, 46.407, 46.663, 46.939, 47.215, 47.491, 47.728, 48.005, 48.282, 48.559, 48.836, 49.093, 49.371, 49.649, 49.927, 50.205, 50.483, 50.762, 51.041, 51.3, 51.579, 51.859, 52.138, 52.418, 52.698, 52.978, 53.259, 53.54, 53.82, 54.101, 54.383, 54.664, 54.946, 55.228, 55.51, 55.792, 56.074, 56.337, 56.62, 56.883, 57.166, 57.45, 57.734, 58.018, 58.302, 58.586, 58.871, 59.156, 59.441, 59.726, 59.991]
#voltage =  [0.02497597, 0.02336461, 0.02417029, 0.02094759, 0.02417029, 0.02578164, 0.02417029, 0.2852598, 1.029856, 0.857441, 0.9984344, 0.801799, 3.194456, 1.1709, 1.788199, 0.02819867, 0.974264, 1.656873, 3.186399, 0.8098557, 1.425544, 1.443268, 1.042797, 3.187205, 1.236965, 1.476351, 0.8066331, 1.315972, 3.188011, 0.825214, 1.760806, 1.236965, 2.108958, 1.994502, 1.460238, 1.274882, 1.058105, 3.192039, 0.9807095, 1.540806, 1.128199, 3.187205, 2.005782, 1.664124, 1.113696, 1.236965, 3.184788, 1.270854, 1.693934, 1.061327, 1.228102, 3.186399, 0.9090043, 1.442463, 1.115308, 1.154786, 3.175926, 1.365924, 1.716493, 1.077441, 1.373175, 3.162229, 1.397345, 1.226491, 2.155688, 1.347393, 1.261991, 1.197487, 2.988153, 1.927631, 1.374786, 3.188011, 1.669764, 1.365118, 3.165452, 1.090332, 1.041991, 1.88493, 2.646445, 1.524692, 1.316777, 3.188817, 1.102417, 1.081469, 1.415875, 2.535262, 1.358672, 1.238627, 3.163035, 1.589146, 1.307109, 3.192845, 1.691517, 1.589146, 3.175926, 1.423127, 3.186399, 1.859149, 1.145118, 3.192845, 1.517441, 1.384454, 3.181566, 2.33057, 1.465072, 1.808341, 3.175926, 1.347393, 1.677821, 3.201707, 3.163841, 1.764028, 3.178343, 3.112277, 1.684266, 3.188817, 3.170286, 1.72455, 3.197679, 3.166258, 1.633458, 3.188011, 2.86564, 1.822843, 3.174314, 2.261231, 3.183177, 3.195262, 1.78417, 3.163841, 2.944646, 2.117015, 3.191234, 1.563365, 2.308011, 3.188011, 1.908295, 3.078388, 3.17512, 1.699574, 2.220948, 3.172703, 2.092039, 1.989668, 3.167869, 3.168675, 2.007393, 3.185594, 3.171897, 1.53436, 1.984028, 3.171897, 3.174314, 1.834122, 3.197679, 3.175926, 1.786587, 3.173509, 3.194456, 2.062179, 3.164646, 3.170286, 1.903461, 3.192039, 3.179148, 1.57545, 3.189622, 3.196068, 1.912323, 3.166258, 3.188011, 1.909906, 3.175926, 3.195262, 2.067063, 3.197679, 3.167869, 3.178343, 3.182371, 3.188011, 3.172703, 3.201707, 1.775308, 3.171897, 3.178343, 3.183177, 3.189622, 2.14038, 3.206542, 3.194456, 3.02038, 2.595688, 2.135546, 3.182371, 3.193651, 2.395024, 3.181566, 3.16948, 3.185594, 3.17512, 3.189622, 3.195262, 3.178343, 3.19929, 3.167869, 3.174314, 3.191234, 2.5691, 3.188011, 3.166258, 3.193651, 3.167063, 3.18076, 3.192039, 3.178343, 3.192039, 2.588437, 3.184788, 3.171897, 3.179954, 2.54493, 3.181566, 3.188011, 2.910002, 3.189622, 3.196068, 3.174314, 3.183177, 3.188817, 3.181566, 3.167869, 3.196068, 3.194456, 3.204124, 3.179954, 3.173509, 3.191234, 3.175926, 3.16948, 3.191234, 3.16948, 3.166258, 3.182371, 3.176731, 3.173509, 3.200096, 3.189622, 3.198485, 3.173509, 3.167063, 3.179954, 3.16948, 3.186399]

#trey3
time = [0.002, 0.174, 0.344, 0.515, 0.665, 0.8360001, 1.007, 1.178, 1.349, 1.521, 1.662, 1.823, 1.975, 2.136, 2.288, 2.45, 2.602, 2.755, 2.918, 3.081, 3.244, 3.397, 3.56, 3.713, 3.877, 4.041, 4.195, 4.359, 4.513, 4.678, 4.833, 4.987, 5.152, 5.307, 5.473, 5.639, 5.795, 5.961, 6.117, 6.283, 6.45, 6.606, 6.774, 6.93, 7.098, 7.266, 7.423, 7.591, 7.748, 7.895, 8.063, 8.221, 8.379, 8.526, 8.684, 8.843, 9.001, 9.182, 9.352, 9.522, 9.681, 9.942, 10.203, 10.447, 10.709, 10.971, 11.217, 11.48, 11.725, 11.989, 12.252, 12.516, 12.78, 13.027, 13.292, 13.556, 13.804, 14.052, 14.317, 14.565, 14.831, 15.079, 15.346, 15.595, 15.844, 16.111, 16.36, 16.61, 16.86, 17.11, 17.361, 17.611, 17.88, 18.131, 18.382, 18.634, 18.868, 19.119, 19.371, 19.624, 19.876, 20.129, 20.399, 20.653, 20.906, 21.159, 21.413, 21.667, 21.939, 22.194, 22.448, 22.721, 22.994, 23.249, 23.504, 23.76, 24.016, 24.272, 24.51, 24.784, 25.041, 25.298, 25.555, 25.794, 26.051, 26.327, 26.585, 26.861, 27.119, 27.379, 27.638, 27.898, 28.158, 28.418, 28.679, 28.94, 29.201, 29.463, 29.724, 29.986, 30.248, 30.511, 30.755, 31.017, 31.28, 31.544, 31.807, 32.071, 32.335, 32.599, 32.863, 33.127, 33.373, 33.638, 33.884, 34.13, 34.396, 34.662, 34.928, 35.194, 35.46, 35.726, 35.993, 36.26, 36.527, 36.795, 37.062, 37.33, 37.617, 37.885, 38.135, 38.403, 38.672, 38.941, 39.21, 39.48, 39.749, 40.019, 40.27, 40.541, 40.811, 41.082, 41.353, 41.624, 41.895, 42.167, 42.439, 42.711, 42.983, 43.255, 43.508, 43.781, 44.054, 44.327, 44.601, 44.875, 45.148, 45.422, 45.697, 45.971, 46.246, 46.521, 46.796, 47.071, 47.347, 47.622, 47.898, 48.155, 48.411, 48.688, 48.965, 49.242, 49.519, 49.796, 50.074, 50.352, 50.63, 50.908, 51.186, 51.465, 51.744, 52.043, 52.322, 52.601, 52.881, 53.141, 53.441, 53.721, 53.982, 54.262, 54.523, 54.804, 55.086, 55.367, 55.669, 55.951, 56.233, 56.515, 56.818, 57.101, 57.384, 57.667, 57.95, 58.254, 58.538, 58.801, 59.086, 59.35, 59.634, 59.919]
voltage = [0.02417029, 0.02094759, 0.03544976, 0.027393, 0.02417029, 0.02819867, 0.02658732, 0.02658732, 0.02578164, 0.93962, 0.4012772, 2.757679, 0.4295262, 1.335308, 0.8534126, 1.236965, 1.638292, 0.5092881, 0.9992401, 0.8429388, 2.673838, 0.6446921, 1.123365, 0.8106614, 0.9847379, 2.831801, 0.8421331, 1.190236, 0.9138384, 1.090332, 2.964788, 0.9363974, 1.145118, 0.9887663, 0.6881986, 2.790712, 0.9589562, 1.192653, 0.9331746, 0.8582467, 2.839858, 0.6591943, 1.365924, 0.8558296, 0.7881025, 3.064692, 0.6769192, 1.172511, 1.02905, 0.9662073, 3.174314, 1.434406, 1.75436, 0.437583, 1.666541, 2.297537, 0.02578164, 0.5447379, 0.9033646, 2.923699, 0.6640284, 0.8719433, 2.768153, 0.9508995, 0.7204257, 0.687393, 0.8671092, 2.689197, 0.9251179, 0.9218951, 0.4214694, 0.7937422, 2.617441, 0.9315633, 0.6914213, 1.958247, 1.216017, 0.8646921, 2.651279, 0.9815151, 0.771989, 0.7679606, 1.353838, 1.214406, 0.9130327, 1.512607, 0.964596, 1.132227, 1.104028, 3.007489, 1.348199, 0.9887663, 1.622985, 1.028244, 0.827631, 1.18943, 2.320902, 1.473935, 1.182179, 2.101707, 1.190236, 0.7913252, 2.733509, 1.203932, 1.036352, 3.172703, 1.240238, 0.8469672, 3.178343, 1.052465, 0.8381048, 0.9718471, 2.071092, 1.018576, 1.058105, 1.133033, 3.171092, 1.15398, 0.9871549, 1.033129, 1.697963, 1.339336, 1.06455, 2.190332, 0.9243122, 1.144312, 0.8130785, 1.369952, 1.164454, 1.106445, 3.105026, 1.412653, 1.188624, 1.526303, 1.062133, 1.077441, 1.113696, 2.027535, 1.508579, 1.156397, 2.154076, 1.09436, 1.112891, 1.172511, 2.167773, 1.539194, 1.129004, 3.097775, 1.182985, 1.115308, 1.187819, 1.81962, 1.494076, 1.02905, 3.17512, 1.272465, 1.083081, 1.199098, 1.576255, 1.361895, 1.259574, 3.189622, 1.701186, 1.187013, 3.185594, 1.326445, 1.111279, 0.5390982, 1.261186, 1.12981, 1.137061, 1.541611, 1.408624, 1.261991, 2.656919, 1.581895, 1.214406, 1.95019, 1.568199, 1.225685, 1.523081, 1.315166, 2.064646, 1.050854, 1.137867, 2.578768, 1.508579, 1.839762, 1.089526, 1.12417, 2.679478, 1.585924, 1.133033, 1.167677, 1.492465, 1.239432, 1.286967, 3.179954, 1.390094, 1.274882, 3.165452, 1.444124, 1.050048, 3.019574, 1.502133, 1.198292, 2.11621, 1.53436, 1.306304, 1.384454, 1.250712, 1.747109, 1.109668, 1.309526, 3.054218, 1.524692, 1.042797, 1.478769, 1.400568, 2.004976, 0.9710414, 1.113696, 1.400568, 1.138672, 1.07019, 0.6632227, 1.508579, 1.84379, 0.574548, 2.02109, 1.194264, 1.057299, 2.647251, 0.9001419, 0.657583, 3.177537, 1.361089, 0.9025589, 1.947773, 1.898627, 1.377203, 0.937203, 0.9162554, 3.175926, 1.22488, 1.108862, 3.17512, 1.128199, 1.144312, 3.175926]

class Model():

  @staticmethod
  def HeartRate(timeList:list=time, voltageList:list=voltage):
    assert len(timeList) == len(voltageList)
    n = 1 # number of relative points for localmax

    df = pd.DataFrame()
    df['time'] = timeList
    df['voltage'] = voltageList
    df.voltage = df.voltage.round(2)
    df[f'peaks'] = df.iloc[argrelextrema(df[f'voltage'].values, np.greater_equal, order=n)[0]]['voltage']
    heartRate = round(len(df[df.peaks > 0]) / df.iloc[-1].time * 60, 0)

    print(df)
    print(heartRate)
    return (df, heartRate)

  @staticmethod
  def Graph():
    import plotly_express as px
    from plotly.subplots import make_subplots
    
    df, heartRate = Model.HeartRate()

    figures = [
      px.line(df, x='time', y='voltage'), #, trendline='ols', trendline_scope='overall'),
      px.bar(df[df.peaks > 0], x='time', y='peaks', text='peaks'),
      px.bar(pd.DataFrame({'output':[0], 'value':[heartRate]}), x='output', y='value', text='value')
        ]

    fig = make_subplots(
        rows=len(figures), 
        cols=1, 
        shared_xaxes=False, 
        vertical_spacing = 0.1,
        subplot_titles=[
          'Voltage/time', 
          'Peak Voltage', 
          'Beats/minute', 
        ]) 

    for i, figure in enumerate(figures):
        for trace in range(len(figure["data"])):
            fig.append_trace(figure["data"][trace], row=i+1, col=1)
            if i == 0:
              fig.add_hline(y=3)
              fig.add_hline(y=0.6)


    fig.update_layout(template='plotly_dark', height=700, xaxis=dict(domain=[0,1]))
    fig.show()

if __name__ == '__main__':
  #Do Model.Graph() or Model.HeartRate()
  Model.Graph()
